<!doctype html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns:th="http://www.thymeleaf.org"
      layout:decorate="~{layout/default}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>펫시터의 이름</title>
    <link rel="stylesheet" href="https://cdn.mobiscroll.com/4.10.4/css/mobiscroll.min.css">
    <script src="https://cdn.mobiscroll.com/4.10.4/js/mobiscroll.jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!--    flatdatepicker-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ko.js"></script>

    <!--    타임피커 필요한 스크립트-->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="//code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.css">

    <script src="https://code.jquery.com/jquery-3.2.1.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.js"></script>
    <style>
        .selectTime {
            width: 375px;
            border-radius: 8px;
            border: 1px solid #DFE3EA;
            box-shadow: 1px 3px 7px rgba(0, 0, 0, 0.07);
            padding-left: 32px;
            padding-right: 32px;
            padding-bottom: 32px;
        }

        .selectPet {

        }

        input[type=number]::-webkit-outer-spin-button,
        input[type=number]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        input[type="number"] {
            width: 3em;
        }

        .totalPrice {
            margin-left: 5px;
            margin-right: 5px;
        }

        img {
            width: 150px;
            height: 60px;
            margin: 3%;
        }

        .petSize {
            width: 150px;
            height: 70px;
            margin: 3%;
        }

        textarea {
            width: 100%;
            height: 7em;
            border: 1px solid black;
            resize: none;
        }

        .serviceList {
            display: flex;
            flex-wrap: wrap;
            flex-direction: row
        }

        .serviceList > .service {
            display: flex;
            flex-direction: row;
            align-items: center;
            width: 200px;
            height: 69px;
        }

        p {
            font-size: 14px;
            letter-spacing: -0.2px;
            line-height: 20px;
            color: #393C47;
            margin-top: 38px

        }
    </style>
</head>
<body>

<main layout:fragment="main" class="page-body">
    <section class="hero-wrap hero-wrap-2" style="background-image: url('/images/bg_2.jpg');"
             data-stellar-background-ratio="0.5"> <!--여기에 사용자가 등록한 사진을 넣으면 되겠다-->
        <div class="overlay"></div>
        <div class="container">
            <div class="row no-gutters slider-text align-items-end">
                <div class="col-md-9 ftco-animate pb-5">
                    <p class="breadcrumbs mb-2"><span class="mr-2">
                        <a th:href="@{/}">Home
                        <i class="ion-ios-arrow-forward"></i></a></span>
                        <span>펫시터
							<i class="ion-ios-arrow-forward"></i>
						</span>
                    </p>
                    <h1 class="mb-0 bread">여기에 펫시터 이름을 출력</h1>
                </div>
            </div>
        </div>
    </section>
    <div class="container" th:object="${dto}">
        <div style="display: flex;">
            <div style="padding-right: 30px">
                <h2>여기는 포트폴리오를 작성하는 공간입니다</h2>
                <div style="display: flex">
                    <h4 th:text="${dto.getPetSitterId}" name="petSitterId">여기는 사용자의 이름이 들어옵니다</h4>
                    <div style="overflow:scroll; width:500px; height:350px;">
                        <div th:each="images,stat: ${dto.imageUrlList}">
                            <img th:src="${images}" alt="" style="height: 400px; width: 350px">
                        </div>
                    </div>
                </div>
                <div style="padding: 5px">
                    <h4>여기는 자신의 자격증이나 기타 증명이 들어옵니다(대부분 자격증)</h4>
                    <div>
                        <img th:src="@{/images/License.PNG}" alt="증명서">
                    </div>
                    <div>
                        <p>소개 글</p>
                        <p th:text="${dto.getMainIntroduce}"></p>
                    </div>
                    <div>
                        <div class="serviceList">

                            <div th:if="${petService.contains('everydayWalk')}" class="service">
                                <img th:src="@{/images/availableService/everydaywalk.PNG}" alt="everydayWalk">
                            </div>

                            <div th:if="${petService.contains('olderPetWalk')}" class="service">
                                <img th:src="@{/images/availableService/oldpetwalk.PNG}" alt="노견산책">
                            </div>

                            <div th:if="${petService.contains('youngerPetWalk')}" class="service">
                                <img th:src="@{/images/availableService/youngerpetwalk.PNG}" alt="어린견산책">
                            </div>

                            <div th:if="${petService.contains('play')}" class="service">
                                <img th:src="@{/images/availableService/play.PNG}" alt="실내놀이">
                            </div>

                            <div th:if="${petService.contains('firstAid')}" class="service">
                                <img th:src="@{/images/availableService/firstaid.PNG}" alt="응급처리">
                            </div>

                            <div th:if="${petService.contains('walkPickup')}">
                                <img th:src="@{/images/availableService/pickup.PNG}" alt="도보픽업">
                            </div>

                            <div th:if="${petService.contains('brush')}" class="service">
                                <img th:src="@{/images/availableService/brush.PNG}" alt="모발관리">
                            </div>

                            <div th:if="${petService.contains('medicine')}" class="service">
                                <img th:src="@{/images/availableService/medicine.PNG}" alt="약먹이기">
                            </div>

                            <div th:if="${petService.contains('longReservation')}" class="service">
                                <img th:src="@{/images/availableService/longreservation.PNG}" alt="장기예약">
                            </div>


                        </div>
                    </div>
                </div>
                <div style="padding: 5px">
                    <h4>여기는 사용자들의 리뷰가 들어옵니다</h4>
                    <img th:src="@{/images/review.PNG}" alt="리뷰">
                </div>

            </div>

            <div style="padding: 5px">
                <div style="padding: 5px">
                    <div>
                        <div>
                            <p>가능한 날짜</p>
                        </div>
                        <div style="margin: 10px;" class="align-content-end">
                            <form th:action="@{/petsitter/reservation}" method="post">
                                <label for="petSitterId" hidden="hidden">
                                    <input type="text" name="petSitterId" id="petSitterId"
                                           th:value="${dto.getPetSitterId}">
                                </label>
                                <div class="bo_w_tit write_div">
                                    <div class="selectTime">
                                        <div><p>언제 시터가 필요하신가요??</p></div>
                                        <div style="margin-top:20px;">
                                            <p>예약날짜 : </p>
                                            <label for="impossibleDays">
                                                <input type="text" th:value="${dto.impossibleDays}" id="impossibleDays"
                                                       name="reservationDays" required/>
                                            </label>
                                            타임 피커
                                            <label for="start">Start Time:</label>
                                            <input type="text" id="start" placeholder="select time" autocomplete="on" name="startTime" required>

                                            <label for="end">End Time:</label>
                                            <input type="text" id="end" placeholder="select time" autocomplete="on" name="endTime"
                                                   required disabled>
                                        </div>
                                        <div>
                                            <label for="note"></label>
                                            <input type="text" name="note" id="note" placeholder="기타사항을 작성해주세요"
                                                   style="width: 100%">
                                        </div>
                                    </div>
                                    <p>가능한 애견</p>
                                    <div class="selectTime" style=" display: inline-block;"
                                         id="availablePetSize">

                                        <div th:if="${petSize.contains('smallPet')}" class="petSize"
                                             style="display: inline">
                                            <img th:src="@{/images/availablePetSize/smallpet.PNG}" alt="소형견">
                                            <label>
                                                <input name="petSizeAndHowManyPets[0].petSize" value="소형견"
                                                       hidden="hidden">
                                            </label>
                                            <label>
                                                <input type="number" name="petSizeAndHowManyPets[0].howMayPet" min="0">
                                            </label>
                                        </div>

                                        <div th:if="${petSize.contains('middlePet')}" class="petSize"
                                             style="display: inline">
                                            <img th:src="@{/images/availablePetSize/middlepet.PNG}" alt="중형견">
                                            <label>
                                                <input name="petSizeAndHowManyPets[1].petSize" value="중형견"
                                                       hidden="hidden"/>
                                            </label>
                                            <label>
                                                <input type="number" name="petSizeAndHowManyPets[1].howMayPet" min="0"/>
                                            </label>

                                        </div>

                                        <div th:if="${petSize.contains('largePet')}" class="petSize"
                                             style="display: inline">
                                            <img th:src="@{/images/availablePetSize/largepet.PNG}" alt="대형견">
                                            <label>
                                                <input name="petSizeAndHowManyPets[2].petSize" value="대형견"
                                                       hidden="hidden">
                                            </label>
                                            <label>
                                                <input type="number" name="petSizeAndHowManyPets[2].howMayPet" min="0">
                                            </label>

                                        </div>

                                    </div>

                                </div>
                                <button type="submit">예약 시작</button>
                            </form>
                            <div>


                                <!--                                <button id="btn-kakao">예약 요청</button>-->
                                <!--                                <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>-->
                            </div>
                        </div>


                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        // start timepicker
        $('#start').timepicker({
            timeFormat: 'HH:mm',
            interval: 60,
            minTime: '10',
            maxTime: '23:00',
            startTime: '09:00',
            dynamic: false,
            dropdown: true,
            scrollbar: true,
            zindex: '9999999',
            change: function(time){
                var startHour = parseInt( $('#start').val())+1;
                $('#end').prop('disabled', false).prop('readonly', false);

                $('#end').timepicker({
                    'timeFormat': 'HH:mm',
                    'interval': 60,
                    'minTime': startHour,
                    'maxTime': '20:00',
                    'dynamic': false,
                    dropdown: true,
                    scrollbar: true
                });
                console.log("starthours : "+startHour);
                alert($('#start'));
            }

        });
        // End timepicker
        // $('#end').timepicker({
        //     timeFormat: 'HH:mm',
        //     interval: 60,
        //     maxTime: '23:00',
        //     dynamic: false,
        //     dropdown: true,
        //     scrollbar: true,
        // });
    </script>

    <script>
        $("#btn-kakao").click(function () {
            $.ajax({
                url: '/pay/ready',
                type: 'get',
                data: {
                    item_name: '대형견',
                    quantity: "1",
                    total_amount: "70000",
                    tax_free_amount: "0",
                },
                success: function (response) {
                    console.log("결제완료 페이지입니다");
                    alert(response.next_redirect_pc_url); //kakao payment api에서 알아서 응답해주는 url
                    location.href = response.next_redirect_pc_url; // 결제 페이지
                },
                error: function (xhr, err, status) {
                    console.log(xhr.responseText);
                    alert(err + "이(가) 발생했습니다: " + status);
                }
            });
        });
    </script>
    <script th:inline="javascript">

        const impossibleDays = document.getElementById('impossibleDays');

        var dates = [[${dto.impossibleDays}]];

        flatpickr(impossibleDays, {
            dateFormat: "Y-m-d", // 날짜 및 시간 형식 설정 (예: 2023-09-12 15:30)
            enableTime: false,        // 시간 선택 활성화
            time_24hr: false,         // 24시간 형식 사용
            minDate: 'today',        // 오늘 이전 날짜 선택 비활성화
            maxDate: new Date().fp_incr(92), // 14 days from now
            // defaultDate: 'today',    // 초기 날짜 설정 (현재 날짜와 시간)
            inline: true, // 상시 출력
            clickOpens: true, // 클릭으로 달력 출력
            mode: "multiple", // 여러날 선택
            disable: dates, // 특정 날짜 비활성화
            locale: 'ko',            // 한국어로 지역화
            onOpen: function (selectedDates, dateStr, instance) {
                // 위젯이 열릴 때 실행할 코드
            },
            onClose: function (selectedDates, dateStr, instance) {
                // 위젯이 닫힐 때 실행할 코드
            },
            onChange: function (selectedDates, dateStr, instance) {
                // 날짜가 변경될 때 실행할 코드
            },
            disableMobile: true,      // 모바일 기기에서 위젯 비활성화
            altInput: true,           // 추가 입력란 활성화
            // altFormat: 'F j, Y H:i', // 추가 입력란의 날짜 및 시간 형식
        });
    </script>
    <script src="https://npmcdn.com/flatpickr/dist/flatpickr.min.js"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/ko.js"></script>
</main>
</body>
</html>